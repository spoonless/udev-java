
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Les types génériques &#8212; documentation Le langage Java 1.0</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Les classes abstraites" href="classe_abstraite.html" />
    <link rel="prev" title="Les exceptions" href="les_exceptions.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="les-types-generiques">
<h1>Les types génériques<a class="headerlink" href="#les-types-generiques" title="Lien permanent vers ce titre">¶</a></h1>
<p>Parfois, on souhaite créer une classe qui est liée très fortement à un autre type.
C’est souvent le cas quand la classe sert de conteneur à un autre type.</p>
<div class="section" id="l-exemple-de-la-classe-arraylist">
<h2>L’exemple de la classe ArrayList<a class="headerlink" href="#l-exemple-de-la-classe-arraylist" title="Lien permanent vers ce titre">¶</a></h2>
<p>En Java, l’API standard fournit un ensemble de classes que l’on appelle couramment
les collections. Ces classes permettent de gérer un ensemble d’objets. Elles apportent
des fonctionnalités plus avancées que les tableaux. Par exemple la classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">java.util.ArrayList</a>
permet de gérer une liste d’objets. Cette classe autorise l’ajout en fin de liste,
l’insertion, la suppression et bien évidemment l’accès à un élément selon son index
et le parcours complet des éléments.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.cgi.udev</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestArrayList</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ArrayList</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;bonjour le monde&quot;</span><span class="o">);</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// boxing ! list.add(Integer.valueOf(1));</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Object</span><span class="o">());</span>

    <span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="hll">    <span class="n">String</span> <span class="n">s2</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// ERREUR à l&#39;execution : ClassCastException</span>
</span><span class="hll">    <span class="n">String</span> <span class="n">s3</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span> <span class="c1">// ERREUR à l&#39;execution : ClassCastException</span>
</span>  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<p>Avec la classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a>, on peut ajouter des éléments avec la méthode
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html#add-E-">ArrayList.add</a> et accéder à un élément selon son index avec la méthode <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html#get-int-">ArrayList.get</a>.
Dans l’exemple précédent, on voit que cela n’est pas sans risque. En effet, un objet de
type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a> peut contenir tout type d’objet. Donc quand le programme accède à un élément
d’une instance de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a>, il doit réaliser explicitement un trans-typage (<em>cast</em>) avec le risque
que cela suppose de se tromper de type. Ce type de classe exige donc beaucoup de rigueur
d’utilisation pour les développeurs.</p>
<p>Une situation plus simple serait de pouvoir déclarer en tant que développeur qu’une instance
de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a> se limite à un type d’éléments : par exemple au type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a>. Ainsi le
compilateur pourrait signaler une erreur si le programme tente d’ajouter un élément qui n’est
pas compatible avec le type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a> ou s’il veut récupérer un élément dans une variable qui
n’est pas d’un type compatible. Les génériques permettent de gérer ce type de situation.
Ils sont une aide pour les développeurs pour écrire des programmes plus robustes.</p>
</div>
<div class="section" id="declaration-et-creation-d-un-generique">
<h2>Déclaration et création d’un générique<a class="headerlink" href="#declaration-et-creation-d-un-generique" title="Lien permanent vers ce titre">¶</a></h2>
<p>La classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a> est justement une classe supportant les types génériques.
Il est possible, par exemple, de déclarer qu’une instance est une liste de
chaîne de caractères :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
</pre></div>
</div>
<p>On ajoute entre les signes <strong>&lt;</strong> et <strong>&gt;</strong> le paramètre de type géré par la liste.
À partir de cette information, le compilateur va pouvoir nous aider à résoudre
les ambiguïtés. Il peut maintenant déterminer si un élément peut être ajouté ou
référencé par une variable sans nécessiter un trans-typage explicite du développeur.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;bonjour&quot;</span><span class="o">);</span>
<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// l&#39;opération de trans-typage n&#39;est plus nécessaire</span>
</pre></div>
</div>
<p>Par contre :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="hll"><span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// Erreur de compilation : type String attendu</span>
</span>
<span class="n">Object</span> <span class="n">o</span> <span class="o">=</span> <span class="s">&quot;je suis une chaîne affectée à une variable de type Object&quot;</span><span class="o">;</span>
<span class="hll"><span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o</span><span class="o">);</span> <span class="c1">// Erreur de compilation : type String attendu</span>
</span>
<span class="hll"><span class="n">Voiture</span> <span class="n">v</span> <span class="o">=</span> <span class="o">(</span><span class="n">Voiture</span><span class="o">)</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// Erreur de compilation Voiture n&#39;hérite pas de String</span>
</span></pre></div>
</div>
<p>Pour les types génériques, le principe de substitution s’applique. Comme la classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a>
hérite de la classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a>, il est possible de récupérer un élément de ma liste
dans une variable de type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a> :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Object</span> <span class="n">o</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// OK</span>
</pre></div>
</div>
<p>Une classe peut permettre de déclarer plusieurs types génériques. Par exemple
la classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html">java.util.HashMap</a> permet de créer des tableaux associatifs (parfois
appelés dictionnaires ou plus simplement <em>maps</em>) pour associer une clé à une valeur.
La classe <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html">HashMap</a> permet de spécifier le type de la clé et le type de la valeur.
Pour créer un tableau associatif entre le nom d’une personne (type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a>) et
une instance de la classe <em>Personne</em>, on peut écrire :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Personne</span><span class="o">&gt;</span> <span class="n">tableauAssociatif</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Personne</span><span class="o">&gt;();</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Les types génériques ne fonctionnent que pour les objets. On ne peut pas créer
une instance en spécifiant un type primitif. Si on désire créer une instance
de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a> pour des nombres, alors on peut passer par la classe enveloppe
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html">Integer</a> :</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">listeDeNombres</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="notation-en-diamant">
<h2>Notation en diamant<a class="headerlink" href="#notation-en-diamant" title="Lien permanent vers ce titre">¶</a></h2>
<p>Lors de l’initialisation, il n’est pas nécessaire de préciser le type des paramètres
à droite de l’expression. Le compilateur peut réaliser une inférence de types
à partir de la variable à gauche de l’expression :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Personne</span><span class="o">&gt;</span> <span class="n">tableauAssociatif</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">listeDeNombres</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</pre></div>
</div>
<p>Il s’agit d’un raccourci d’écriture qui évite de se répéter. On appelle la notation
<strong>&lt;&gt;</strong>, la notation en diamant.</p>
</div>
<div class="section" id="substitution-et-type-generique">
<h2>Substitution et type générique<a class="headerlink" href="#substitution-et-type-generique" title="Lien permanent vers ce titre">¶</a></h2>
<p>Avec l’héritage, nous avons vu que nous pouvons affecter à une variable, un
paramètre ou un attribut une référence d’un objet du même type ou d’un type
qui en hérite. On appelle cela le principe de substitution.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">();</span>
</pre></div>
</div>
<p>Dans l’exemple ci-dessus, il est possible d’affecter un objet du type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a>
à une variable de type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a> car <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a> hérite de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a>. Avec les types
génériques, le principe de substitution est possible mais devient un peu
plus complexe. Par exemple :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="hll"><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">listeString</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span> <span class="c1">// ERREUR DE COMPILATION</span>
</span></pre></div>
</div>
<p>Il n’est pas possible d’affecter une <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a> de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a> à une variable de type
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">ArrayList</a> de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a>. En effet, si cela était autorisé, il serait alors possible
d’ajouter avec la méthode <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html#get-int-">ArrayList.get</a> n’importe quel objet de type <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a> ou
d’un type héritant de <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html">Object</a>. Donc un développeur pourrait ajouter à cette liste
une instance d’une classe <em>Voiture</em> par exemple sans que le compilateur puisse
détecter le problème :</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="hll"><span class="n">listeString</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Voiture</span><span class="o">());</span> <span class="c1">// Il vaut mieux ne pas pouvoir faire cela !</span>
</span></pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">À faire</p>
<ul class="last simple">
<li>Pourquoi les génériques : les classes de qqchose (liste de, facture de, conteneur de)</li>
<li>Le cas de la classe ArrayList</li>
<li>utiliser des génériques (la notation en diamant pour l’initialisation)</li>
<li>Les règles de typage pour l’affectation et les paramètres (ArrayList&lt;T&gt; -&gt; ArrayList&lt;V&gt;)</li>
<li>écrire des méthodes génériques (paramètres et type de retour)</li>
<li>écrire des classes génériques</li>
<li>Bounded type &lt;T extends XXX&gt; &lt;T super XXX&gt;</li>
<li>? le caractère générique</li>
<li>Limitation : instanceof, pas d’instanciation générique</li>
<li>le cas du &#64;SuppressWarnings</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Le langage Java</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Compilation &amp; exécution</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_fondamentale.html">La structure fondamentale du langage</a></li>
<li class="toctree-l1"><a class="reference internal" href="premiere_classe.html">Une première classe</a></li>
<li class="toctree-l1"><a class="reference internal" href="types_primitifs.html">Les types primitifs</a></li>
<li class="toctree-l1"><a class="reference internal" href="operateurs.html">Les opérateurs</a></li>
<li class="toctree-l1"><a class="reference internal" href="structures_de_controle.html">Les structures de contrôle</a></li>
<li class="toctree-l1"><a class="reference internal" href="attributs_et_methodes.html">Attributs &amp; méthodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tableau.html">Les tableaux</a></li>
<li class="toctree-l1"><a class="reference internal" href="cycle_de_vie.html">Cycle de vie d’un objet</a></li>
<li class="toctree-l1"><a class="reference internal" href="package.html">Les packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="relations_entre_objets.html">Les relations entre objets</a></li>
<li class="toctree-l1"><a class="reference internal" href="polymorphisme.html">Le polymorphisme</a></li>
<li class="toctree-l1"><a class="reference internal" href="la_classe_object.html">La classe Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="la_classe_string.html">La classe String</a></li>
<li class="toctree-l1"><a class="reference internal" href="les_exceptions.html">Les exceptions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Les types génériques</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#l-exemple-de-la-classe-arraylist">L’exemple de la classe ArrayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="#declaration-et-creation-d-un-generique">Déclaration et création d’un générique</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notation-en-diamant">Notation en diamant</a></li>
<li class="toctree-l2"><a class="reference internal" href="#substitution-et-type-generique">Substitution et type générique</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classe_abstraite.html">Les classes abstraites</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumeration.html">Les énumérations</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Les interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="classe_interne.html">Les classes internes</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://docs.oracle.com/javase/8/docs/">Documentation Java</a></li>
    
    <li class="toctree-l1"><a href="http://docs.oracle.com/javase/8/docs/api/index.html?overview-summary.html">API Java</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;
<a ref="author" href="mailto:david.gayerie.epsi@mailoo.org">David Gayerie</a>
<a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/fr/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/fr/80x15.png" /></a>
.
      
    </div>

    

    
  </body>
</html>